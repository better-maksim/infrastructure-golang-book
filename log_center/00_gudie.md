# 项目背景

每个业务系统都会有日志，当系统出现问题的时候，我们需要日志信息定位和解决问题。当系统比较少的时候，登录到服务器上查看即可满足查看日志的需求，但当系统规模巨大时候，可能计算节点有 1W 甚至是 10W 的时候，我们登录机器查看日志，几乎是不现实的。

# 解决方案

把机器上的日志试试手机，统一的存储到中心系统，在对这些日志建立索引，通过搜索即可快速找到对应的日志记录，通过提供一个界面友好的 web 页面实现日志的检索与展示。



# 面临的问题

实时日志量非常大，每天处理几十亿条，日志准实时收集，延迟控制在分钟级别。能够支持水平扩展。



# 业界方案

ELK

![image-20211219215159549](/Users/guozhu/Library/Application Support/typora-user-images/image-20211219215159549.png)

ELK 面临的问题

- 运维成本高，每增加一个日志收集项，都需要手动修改配置
- 监控缺失，无法准确获取 logstatsh 的状态
- 无法做到定制化开发与维护



![image-20211219215301177](/Users/guozhu/Library/Application Support/typora-user-images/image-20211219215301177.png)

手写一个 agent->kafka-》 tranfer 取日志的，发送到 es中。

# 组件

- logAgent 日志手机客户端，用来收集日志上的日志
- Kafka 高吞吐量的分布式协议队列
- ES：开源的搜索引擎
- kibana 

etcd 监听 agent，配置中心，热加载配置。



